<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
body {
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:#f5f5f7;
  color:#222;
}

header {
  background:#111;
  color:#fff;
  padding:16px;
  text-align:center;
  position:sticky;
  top:0;
  z-index:10;
}

.today-btn {
  margin-top:10px;
  padding:8px 18px;
  border:none;
  border-radius:999px;
  background:#0a8a43;
  color:#fff;
}

.container {
  max-width:960px;
  margin:0 auto;
  padding:16px;
}

.card {
  background:#fff;
  border-radius:16px;
  padding:14px;
  margin-bottom:16px;
  box-shadow:0 6px 16px rgba(0,0,0,.06);
}

h2 {
  font-size:16px;
  margin-bottom:10px;
  text-align:center;
}

input {
  padding:6px 10px;
  font-size:14px;
  border-radius:8px;
  border:1px solid #ccc;
}

button.primary {
  padding:8px 16px;
  border-radius:999px;
  border:none;
  background:#007aff;
  color:#fff;
}

.warning {
  color:#c00;
  font-size:13px;
  margin-top:6px;
  text-align:center;
}

/* ë‚ ì§œ + ì¡°íšŒ ë²„íŠ¼ ê°€ìš´ë° ì •ë ¬ */
.date-row {
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
  margin-bottom:6px;
}

.table-wrap {
  overflow-x:auto;
  margin-top:8px;
}

table {
  border-collapse:collapse;
  min-width:600px;
  width:max-content;
  font-size:11.5px;
}

th, td {
  padding:6px 8px;
  border-bottom:1px solid #eee;
  text-align:center;
  white-space:nowrap;
}

th { background:#fafafa; }

.name-col {
  position:sticky;
  left:0;
  background:#fff;
  font-weight:700;
  z-index:2;
}

/* ë¼ìš´ë“œ ì‹œì¸ì„± (íŒŒë‘ê³„ì—´) */
.round-1 { color:#4B5FA8; }
.round-2 { color:#66B2FF; }
.round-3 { color:#1E88E5; }
.round-4 { color:#0D47A1; font-weight:600; }

/* â“ ë„ì›€ë§ ë²„íŠ¼ */
.help-btn {
  position:fixed;
  right:14px;
  bottom:14px;
  width:44px;
  height:44px;
  border-radius:50%;
  border:none;
  background:#007aff;
  color:#fff;
  font-size:22px;
  font-weight:800;
  box-shadow:0 4px 10px rgba(0,0,0,.25);
  z-index:50;
}

/* ê³µì§€ */
.notice {
  font-size:13px;
  line-height:1.5;
  color:#333;
}
.notice ul{ margin:8px 0 0; padding-left:18px; }
.notice li{ margin:4px 0; }
.notice .tag{
  display:inline-block;
  font-size:12px;
  padding:2px 8px;
  border-radius:999px;
  background:#eef5ff;
  color:#0D47A1;
  margin-right:6px;
}
</style>
</head>

<body>

<header>
  <div style="font-size:22px;font-weight:800;">íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</div>
  <button class="today-btn" onclick="goToday()">ì˜¤ëŠ˜ë„ í™”ì´íŒ…~â€¼ï¸</button>
</header>

<div class="container">

  <div class="card">
    <h2>ğŸ¥âœˆï¸ íŠ¸ë¦¼ 2ë°˜ ì „ì²´ ìŠ¤ì¼€ì¤„ ì¡°íšŒí•˜ê¸° ğŸ€ğŸ¥</h2>

    <div class="date-row">
      <input type="date" id="dayDate" />
      <button class="primary" onclick="renderDay()">ì¡°íšŒ</button>
    </div>

    <div id="dayWarn" class="warning"></div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th class="name-col">ì´ë¦„</th>
            <th>1R</th>
            <th>2R</th>
            <th>3R</th>
            <th>4R</th>
          </tr>
        </thead>
        <tbody id="dayBody"></tbody>
      </table>
    </div>
  </div>

  <!-- âœ… ê³µì§€(ì½”ë“œ ê³ ì •: ëª¨ë‘ì—ê²Œ ë™ì¼) -->
  <div class="card">
    <h2>ğŸ“Œ ê³µì§€</h2>
    <div class="notice">
      <div><span class="tag">ë°˜ì˜</span> 2026-01-19 ì¸ì›/ì‘ì—… ì¶”ê°€ (ë¬¸ì •, ì¡±ì¥(SCU))</div>
      <div><span class="tag">ë°˜ì˜</span> 2026-01-22 4ë¼ìš´ë“œ íœ´ë¬´ â†’ 2026-01-23 1ë¼ìš´ë“œë¡œ ì´ì›”(í•œ ì¹¸ ë°€ë¦¼)</div>
      <div><span class="tag">ë°˜ì˜</span> ì„¤ë‚  íœ´ë¬´ (2026-02-16 ~ 2026-02-19)</div>
      <ul>
        <li>ë¯¸ë˜ ë‚ ì§œë„ ë¯¸ë¦¬ ì¡°íšŒ ê°€ëŠ¥ (ì˜ˆ: 1/25)</li>
      </ul>
    </div>
  </div>

</div>

<!-- â“ ë„ì›€ë§ ë²„íŠ¼ -->
<button class="help-btn" id="helpBtn">?</button>

<script>
/* =========================
   âœ… ë²„ì „ / ìµœì¢…ìˆ˜ì •ì¼
   ========================= */
const APP_VERSION = "v-final";
const LAST_UPDATED = "2026-01-16";

/* ===== ì•„ì´í° ì•ˆì „ ë‚ ì§œ íŒŒì‹± ===== */
function parseDate(v){
  if(!v) return null;
  const [y,m,d] = v.split('-').map(Number);
  return new Date(y, m-1, d);
}

/* ===== ë¡œì»¬(í•œêµ­ì‹œê°„) ISO ë¬¸ìì—´ ===== */
function pad2(n){ return String(n).padStart(2,'0'); }
function isoLocal(d){
  return d.getFullYear() + "-" + pad2(d.getMonth()+1) + "-" + pad2(d.getDate());
}
function dateFromISO(iso){
  const [y,m,d] = iso.split("-").map(Number);
  return new Date(y, m-1, d);
}

/* =========================
   âœ… ê¸°ë³¸ ìš´ì˜ ê·œì¹™
   ========================= */
const START = new Date(2026,0,5); // 2026-01-05ë¶€í„°

/* ì„¤ë‚  íœ´ë¬´ */
const HOLIDAYS = ["2026-02-16","2026-02-17","2026-02-18","2026-02-19"];

/* =========================
   âœ… 1/19 ë³€ê²½ë¶„(ì¸ì›/ì‘ì—… ì¶”ê°€)
   ========================= */
const names = [
  "ì˜í›ˆ","ê°‘ìˆ˜","ê¸°ë°±","ìš°ë¹ˆ","ìŠ¹í˜¸","ì›…ê¸°","í•™í˜„","ë²”ì„±","ì„±í•´",
  "ì‘ê·œ","ì˜í™˜","ìƒê±´","ì¬ë•","ì˜¥ì—°","ìˆ˜ì‹ ","ì˜¤ì±„","ì€ìš°","ì •í›ˆ","ìš©ë‚¨",
  "ì„±í›ˆ","ì›ë¹ˆ","ê¸¸ìš´","ëŒ€í˜„","ì§„ì†”","ì¤€í˜„","ë¬¸ì •","ì„œì§„","ì´ìŠ¬","ë¯¼êµ­","ì„±ì²œ","ì¶©í›ˆ"
];

const tasks = [
  "LHíœ€ë‹¤","LH Bí•„ë¼","Lì—ì–´ë°±íˆ¬ì…","2ì¡°1ë²ˆ","LH Cí•„ë¼",
  "SKì£¼ìœ êµ¬","ë©¤ë²„ì–´ìŠ¤","LH Aí•„ë¼","ë§ˆìŠ¤í„°ë°±","Lë„ì–´íƒˆê±°",
  "ë‚š1","ë²”í¼ê°€ì´ë“œ","2ì¡°2ë²ˆ","ASì»¤ë²„","ì¡±ì¥(SCU)","LH ë£¨1","LH ë£¨2",
  "RH íœ€ë‹¤","RH Bí•„ë¼","Rì—ì–´ë°±íˆ¬ì…","RH Cí•„ë¼","R Aí•„ë¼",
  "í›„ë“œ","3ì¡°1ë²ˆ","Rë„ì–´íƒˆê±°","í•˜ì´ë“œë¡œë‹‰ì²´ê²°","ë‚š2","ì—”ì§„ì–´ìŠ¤",
  "3ì¡°2ë²ˆ","RH ë£¨1","RH ë£¨2"
];

/* 1/19 ê¸°ì¤€: 1ë¼ìš´ë“œ(ì²«ë²ˆì§¸ ì‘ì—…=tasks[0]) LHíœ€ë‹¤ ì‘ì—…ì = ìƒê±´ */
const BASE_DATE = "2026-01-19";
const BASE_PERSON = "ìƒê±´";

/* =========================
   âœ… íŠ¹ìˆ˜ ë¼ìš´ë“œ íœ´ë¬´/ì´ì›”
   - 2026-01-22: 4ë¼ìš´ë“œ íœ´ë¬´(ë¯¸ìˆ˜í–‰)
   => ê·¸ ë‹¤ìŒ ìˆ˜í–‰ ìŠ¬ë¡¯ì´ 1ì¹¸ ë‹¹ê²¨ì§€ë¯€ë¡œ 2026-01-23 1ë¼ìš´ë“œë¶€í„° í•œ ì¹¸ ë°€ë¦¼
   ========================= */
const ROUND_OFF = {
  "2026-01-22": [4]
};

function isRoundOff(isoDate, roundNum){
  const arr = ROUND_OFF[isoDate];
  return Array.isArray(arr) && arr.includes(roundNum);
}
function offCountForDay(isoDate){
  const arr = ROUND_OFF[isoDate];
  return Array.isArray(arr) ? arr.length : 0;
}

/* =========================
   âœ… ê·¼ë¬´ì¼ íŒë‹¨
   ========================= */
function isWork(d){
  if(d < START) return false;
  if(d.getDay() === 0) return false;          // ì¼ìš”ì¼
  return !HOLIDAYS.includes(isoLocal(d));     // ì„¤ë‚  íœ´ë¬´
}

/* =========================
   âœ… ê¸°ì¤€ì¼ë¶€í„° target ë‚ ì§œ "ì‹œì‘"ê¹Œì§€ ìˆ˜í–‰í•œ ìŠ¬ë¡¯ ëˆ„ì 
   - ê¸°ë³¸ 4ìŠ¬ë¡¯/ì¼
   - íŠ¹ì •ì¼ì€ (4 - íœ´ë¬´ë¼ìš´ë“œìˆ˜)ë§Œí¼ë§Œ ìˆ˜í–‰
   ========================= */
function slotsBetween(baseISO, targetISO){
  const base = dateFromISO(baseISO);
  const target = dateFromISO(targetISO);

  if(isoLocal(base) === isoLocal(target)) return 0;

  let slots = 0;

  if(base < target){
    let d = new Date(base.getTime());
    while(isoLocal(d) !== isoLocal(target)){
      if(isWork(d)){
        const isoD = isoLocal(d);
        slots += (4 - offCountForDay(isoD));
      }
      d.setDate(d.getDate()+1);
    }
    return slots;
  }

  if(base > target){
    let d = new Date(target.getTime());
    while(isoLocal(d) !== isoLocal(base)){
      if(isWork(d)){
        const isoD = isoLocal(d);
        slots += (4 - offCountForDay(isoD));
      }
      d.setDate(d.getDate()+1);
    }
    return -slots;
  }

  return 0;
}

/* =========================
   âœ… í•´ë‹¹ ë‚ ì§œ ì•ˆì—ì„œ round ì´ì „ì— "ì‹¤ì œ ìˆ˜í–‰ëœ ìŠ¬ë¡¯" ìˆ˜
   - íœ´ë¬´ ë¼ìš´ë“œê°€ ìˆìœ¼ë©´ ê·¸ë§Œí¼ ì œì™¸
   ========================= */
function slotsBeforeRoundInDay(isoDate, roundNum){
  let cnt = 0;
  for(let r=1; r<roundNum; r++){
    if(!isRoundOff(isoDate, r)) cnt += 1;
  }
  return cnt;
}

/* =========================
   âœ… ìŠ¤ì¼€ì¤„ ê³„ì‚°
   - ì‘ì—… ê¸°ì¤€ì€ "í•­ìƒ tasks[0]" (ì ê¸ˆX, ë¦¬ìŠ¤íŠ¸ ì²«ë²ˆì§¸)
   - BASE_DATEì˜ 1Rì—ì„œ BASE_PERSONì´ tasks[0] ìˆ˜í–‰
   - ë¼ìš´ë“œ íœ´ë¬´/ì´ì›”ì€ 'ìˆ˜í–‰ ìŠ¬ë¡¯' ê¸°ì¤€ìœ¼ë¡œ ìë™ ë°€ë¦¼
   ========================= */
function getScheduleForDate(d){
  if(!isWork(d)) return null;

  const isoD = isoLocal(d);

  const basePersonIdx = names.indexOf(BASE_PERSON);
  if(basePersonIdx < 0) return null;

  const baseTaskIdx = 0; // í•­ìƒ ì²« ì‘ì—…

  // ë‚ ì§œ ì‹œì‘ê¹Œì§€ ëˆ„ì  ìˆ˜í–‰ ìŠ¬ë¡¯(íœ´ë¬´ ë¼ìš´ë“œ ë°˜ì˜)
  const shiftSlots = slotsBetween(BASE_DATE, isoD);

  return names.map((name, personIdx)=>{
    const rounds = [];

    for(let r=1; r<=4; r++){
      if(isRoundOff(isoD, r)){
        rounds.push("íœ´ë¬´");
        continue;
      }

      const inDaySlots = slotsBeforeRoundInDay(isoD, r);
      const slot = shiftSlots + inDaySlots;

      const rawIdx = (baseTaskIdx + (personIdx - basePersonIdx) + slot) % tasks.length;
      const taskIdx = (rawIdx + tasks.length) % tasks.length;

      rounds.push(tasks[taskIdx]);
    }

    return { name, rounds };
  });
}

/* ===== ì¶œë ¥ ===== */
function renderDay(){
  const d = parseDate(document.getElementById("dayDate").value);
  const dayBody = document.getElementById("dayBody");
  const dayWarn = document.getElementById("dayWarn");
  dayBody.innerHTML = "";

  if(!d){
    dayWarn.textContent = "ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";
    return;
  }

  if(!isWork(d)){
    dayWarn.textContent = "íœ´ë¬´ì¼ì…ë‹ˆë‹¤.";
    return;
  }

  const s = getScheduleForDate(d);
  if(!s){
    dayWarn.textContent = "ìŠ¤ì¼€ì¤„ ê³„ì‚° ì˜¤ë¥˜ (ê¸°ì¤€ ì‘ì—…ì/ë°ì´í„° í™•ì¸ í•„ìš”)";
    return;
  }

  dayWarn.textContent = "";

  s.forEach(r=>{
    dayBody.innerHTML += `
      <tr>
        <td class="name-col">${r.name}</td>
        <td class="round-1">${r.rounds[0]}</td>
        <td class="round-2">${r.rounds[1]}</td>
        <td class="round-3">${r.rounds[2]}</td>
        <td class="round-4">${r.rounds[3]}</td>
      </tr>
    `;
  });
}

/* ===== ì˜¤ëŠ˜ ===== */
function goToday(){
  const t = new Date();
  const d = isWork(t) ? t : START;
  document.getElementById("dayDate").value = isoLocal(d);
  renderDay();
}

/* ===== ë„ì›€ë§ ===== */
document.getElementById("helpBtn").addEventListener("click", ()=>{
  alert(
    "ë§Œë“ ì‚¬ëŒ : ê¹€ì´ìŠ¬\n" +
    "ë²„ì „ : " + APP_VERSION + "\n"
  );
});

goToday();
</script>

</body>
</html>