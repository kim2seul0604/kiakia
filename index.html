<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:#f5f5f7}
.header{background:#111;color:#fff;text-align:center;padding:14px;position:sticky;top:0;z-index:10}
.header-title{font-size:22px;font-weight:800;margin-bottom:10px}
.today-btn{padding:8px 18px;border-radius:999px;border:none;background:#0a8a43;color:#fff;font-size:14px}
.container{max-width:960px;margin:0 auto;padding:16px}
.card{background:#fff;border-radius:16px;padding:14px;margin-bottom:14px;border:1px solid #ddd}
h2{font-size:16px;margin:0 0 10px}
label{font-size:13px;font-weight:600}
input,select{padding:6px 10px;border-radius:8px;border:1px solid #ccc;font-size:14px;margin-bottom:6px}
button.primary-btn{padding:8px 14px;border-radius:999px;border:none;background:#007aff;color:#fff;font-size:14px}
.weekday-label{font-size:12px;color:#555;margin-left:4px}
.warning{color:#c00;font-size:13px;margin-top:6px}
.table-wrapper{overflow-x:auto;border-radius:12px;border:1px solid #eee}
table{border-collapse:collapse;min-width:600px}
th,td{border-bottom:1px solid #eee;padding:6px 8px;text-align:center}
th{background:#fafafa}
.name-col{position:sticky;left:0;background:#fff;text-align:left;font-weight:600}
.help-btn{position:fixed;right:12px;bottom:12px;width:42px;height:42px;border-radius:50%;border:none;background:#007aff;color:#fff;font-size:20px}
</style>
</head>

<body>
<header class="header">
  <div class="header-title">íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</div>
  <button class="today-btn" id="surveyBtn">ğŸ“‹ íŠ¹ê·¼ ì°¸ì—¬ ì¡°ì‚¬</button>
</header>

<div class="container">

<!-- â‘  ì‘ì—…ëª…ìœ¼ë¡œ ë‹´ë‹¹ì -->
<div class="card">
<h2>â‘  ë‚ ì§œ + ë¼ìš´ë“œ + ì‘ì—…ëª…</h2>
<input type="date" id="lookupDate"><span id="lookupDateWeekday" class="weekday-label"></span><br>
<select id="lookupRound">
<option value="1">1ë¼ìš´ë“œ</option><option value="2">2ë¼ìš´ë“œ</option>
<option value="3">3ë¼ìš´ë“œ</option><option value="4">4ë¼ìš´ë“œ</option>
</select><br>
<select id="lookupTask1"></select><br>
<select id="lookupTask2"></select><br>
<select id="lookupTask3"></select><br>
<button class="primary-btn" onclick="findPerson()">ì¡°íšŒ</button>
<div id="lookupWarning" class="warning"></div>
<div id="lookupResult"></div>
</div>

<!-- â‘¡ ì‘ì—…ìë³„ -->
<div class="card">
<h2>â‘¡ ë‚ ì§œ + ì‘ì—…ì</h2>
<input type="date" id="personDate"><span id="personDateWeekday" class="weekday-label"></span><br>
<select id="personName1"></select><br>
<select id="personName2"></select><br>
<select id="personName3"></select><br>
<button class="primary-btn" onclick="findPersonWork()">ì¡°íšŒ</button>
<div id="personWarning" class="warning"></div>
<div id="personResult"></div>
</div>

<!-- â‘¢ ì „ì²´ -->
<div class="card">
<h2>â‘¢ í•˜ë£¨ ì „ì²´ ìŠ¤ì¼€ì¤„</h2>
<input type="date" id="dateInput"><span id="dateInputWeekday" class="weekday-label"></span>
<button class="primary-btn" onclick="renderDaily()">ì¡°íšŒ</button>
<div id="dailyWarning" class="warning"></div>
<div class="table-wrapper">
<table>
<thead>
<tr><th class="name-col">ì´ë¦„</th><th>1R</th><th>2R</th><th>3R</th><th>4R</th></tr>
</thead>
<tbody id="dailyBody"></tbody>
</table>
</div>
</div>

</div>

<button class="help-btn" onclick="alert('ë§Œë“ ì‚¬ëŒ : ê¹€ì´ìŠ¬')">?</button>

<script>
/* ===== ë°ì´í„° ===== */
const names=["ì˜í›ˆ","ê°‘ìˆ˜","ê¸°ë°±","ìš°ë¹ˆ","ìŠ¹í˜¸","ì›…ê¸°","í•™í˜„","ë²”ì„±","ì„±í•´","ì‘ê·œ","ì˜í™˜","ìƒê±´","ì¬ë•","ì˜¥ì—°","ìˆ˜ì‹ ","ì˜¤ì±„","ì€ìš°","ì •í›ˆ","ìš©ë‚¨","ì„±í›ˆ","ì›ë¹ˆ","ê¸¸ìš´","ëŒ€í˜„","ì§„ì†”","ì„œì§„","ì´ìŠ¬","ë¯¼êµ­","ì„±ì²œ","ì¶©í›ˆ"];
const tasks=["LHíœ€ë‹¤","LH Bí•„ë¼","Lì—ì–´ë°±íˆ¬ì…","2ì¡°1ë²ˆ","LH Cí•„ë¼","SKì£¼ìœ êµ¬","ë©¤ë²„ì–´ìŠ¤","LH Aí•„ë¼","ë§ˆìŠ¤í„°ë°±","Lë„ì–´íƒˆê±°","ë‚š1","ë²”í¼ê°€ì´ë“œ","2ì¡°2ë²ˆ","ASì»¤ë²„","LH ë£¨1","LH ë£¨2","RH íœ€ë‹¤","RH Bí•„ë¼","Rì—ì–´ë°±íˆ¬ì…","RH Cí•„ë¼","R Aí•„ë¼","í›„ë“œ","3ì¡°1ë²ˆ","í•˜ì´ë“œë¡œë‹‰ì²´ê²°","ë‚š2","ì—”ì§„ì–´ìŠ¤","3ì¡°2ë²ˆ","RH ë£¨1","RH ë£¨2"];

const START_DATE=new Date(2025,11,1);
const CHANGE_DATE=new Date(2026,0,5);
const HOLIDAYS=["2025-12-12","2025-12-25"];
const SPECIAL=[{date:"2025-12-09",round:2},{date:"2025-12-19",round:4}];
const wd=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];

/* ===== ìœ í‹¸ ===== */
const iso=d=>d.toISOString().slice(0,10);
const isWork=d=>d>=START_DATE&&d.getDay()!=0&&!HOLIDAYS.includes(iso(d));
const workIdx=d=>{let i=-1;for(let x=new Date(START_DATE);x<=d;x.setDate(x.getDate()+1))if(isWork(x)&&++i&&iso(x)==iso(d))return i;};

/* ===== í•µì‹¬ ìŠ¤ì¼€ì¤„ ===== */
function schedule(date){
 if(!isWork(date))return null;
 let wi=workIdx(date),base=workIdx(CHANGE_DATE);
 let shift=SPECIAL.filter(s=>workIdx(new Date(s.date))<wi).length;
 return names.map((n,i)=>{
   let r=[];
   let offset=(wi-base)*4-shift;
   for(let k=0;k<4;k++)r.push(tasks[(i+offset+k+tasks.length)%tasks.length]);
   let sp=SPECIAL.find(s=>s.date==iso(date));
   if(sp){
     let x=sp.round-1;
     r[x]="X";
     for(let m=x+1;m<4;m++)r[m]=r[m-1];
   }
   return{n,r};
 });
}

/* ===== ë Œë” ===== */
function renderDaily(){
 let d=new Date(dateInput.value);
 let tb=dailyBody;tb.innerHTML="";
 if(!isWork(d)){dailyWarning.textContent="ê·¼ë¬´ì¼ ì•„ë‹˜";return}
 schedule(d).forEach(o=>{
  let tr=document.createElement("tr");
  tr.innerHTML=`<td class="name-col">${o.n}</td>`+o.r.map(x=>`<td>${x}</td>`).join("");
  tb.appendChild(tr);
 });
}

function findPerson(){
 let d=new Date(lookupDate.value),r=lookupRound.value-1;
 if(!isWork(d)){lookupWarning.textContent="ê·¼ë¬´ì¼ ì•„ë‹˜";return}
 let sel=[lookupTask1,lookupTask2,lookupTask3].map(s=>s.value).filter(v=>v);
 lookupResult.innerHTML=sel.map(t=>{
  let f=schedule(d).find(o=>o.r[r]==t);
  return `${t} â†’ ${f?f.n:"ì—†ìŒ"}`;
 }).join("<br>");
}

function findPersonWork(){
 let d=new Date(personDate.value);
 if(!isWork(d)){personWarning.textContent="ê·¼ë¬´ì¼ ì•„ë‹˜";return}
 let sel=[personName1,personName2,personName3].map(s=>s.value).filter(v=>v);
 personResult.innerHTML=sel.map(n=>{
  let o=schedule(d).find(x=>x.n==n);
  return `${n}: ${o.r.join(" / ")}`;
 }).join("<hr>");
}

/* ===== ì´ˆê¸°í™” ===== */
function init(){
 [...personName1,personName2,personName3].forEach(s=>{
  s.innerHTML='<option value="">-ì„ íƒ-</option>'+names.map(n=>`<option>${n}</option>`).join("");
 });
 [...lookupTask1,lookupTask2,lookupTask3].forEach(s=>{
  s.innerHTML='<option value="">-ì„ íƒ-</option>'+tasks.map(t=>`<option>${t}</option>`).join("");
 });
 let t=new Date();dateInput.value=lookupDate.value=personDate.value=iso(t);
 renderDaily();
}
init();
</script>
</body>
</html>