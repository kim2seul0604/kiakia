<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:#f5f5f7;
  color:#222;
}
header{
  background:#111;
  color:#fff;
  padding:16px;
  text-align:center;
  position:sticky;
  top:0;
  z-index:10;
}
.today-btn{
  margin-top:10px;
  padding:8px 18px;
  border:none;
  border-radius:999px;
  background:#0a8a43;
  color:#fff;
}
.container{
  max-width:960px;
  margin:0 auto;
  padding:16px;
}
.card{
  background:#fff;
  border-radius:16px;
  padding:14px;
  margin-bottom:16px;
  box-shadow:0 6px 16px rgba(0,0,0,.06);
}
h2{
  font-size:16px;
  margin-bottom:10px;
  text-align:center;
}
input{
  padding:6px 10px;
  font-size:14px;
  border-radius:8px;
  border:1px solid #ccc;
}
button.primary{
  padding:8px 16px;
  border-radius:999px;
  border:none;
  background:#007aff;
  color:#fff;
}
.warning{
  color:#c00;
  font-size:13px;
  margin-top:6px;
  text-align:center;
}
.date-row{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
  margin-bottom:6px;
}
.table-wrap{
  overflow-x:auto;
  margin-top:8px;
}
table{
  border-collapse:collapse;
  min-width:600px;
  width:max-content;
  font-size:11.5px;
}
th,td{
  padding:6px 8px;
  border-bottom:1px solid #eee;
  text-align:center;
  white-space:nowrap;
}
th{ background:#fafafa; }
.name-col{
  position:sticky;
  left:0;
  background:#fff;
  font-weight:700;
  z-index:2;
}
/* ë¼ìš´ë“œ ì‹œì¸ì„± (íŒŒë‘ê³„ì—´) */
.round-1{ color:#4B5FA8; }
.round-2{ color:#66B2FF; }
.round-3{ color:#1E88E5; }
.round-4{ color:#0D47A1; font-weight:600; }

/* â“ ë„ì›€ë§ ë²„íŠ¼ */
.help-btn{
  position:fixed;
  right:14px;
  bottom:14px;
  width:44px;
  height:44px;
  border-radius:50%;
  border:none;
  background:#007aff;
  color:#fff;
  font-size:22px;
  font-weight:800;
  box-shadow:0 4px 10px rgba(0,0,0,.25);
  z-index:50;
}
</style>
</head>

<body>
<header>
  <div style="font-size:22px;font-weight:800;">íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</div>
  <button class="today-btn" onclick="goToday()">ì˜¤ëŠ˜ë„ í™”ì´íŒ…~â€¼ï¸</button>
</header>

<div class="container">
  <div class="card">
    <h2>ğŸ¥âœˆï¸ íŠ¸ë¦¼ 2ë°˜ ì „ì²´ ìŠ¤ì¼€ì¤„ ì¡°íšŒí•˜ê¸° ğŸ€ğŸ¥</h2>

    <div class="date-row">
      <input type="date" id="dayDate">
      <button class="primary" onclick="renderDay()">ì¡°íšŒ</button>
    </div>

    <div id="dayWarn" class="warning"></div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th class="name-col">ì´ë¦„</th>
            <th>1R</th>
            <th>2R</th>
            <th>3R</th>
            <th>4R</th>
          </tr>
        </thead>
        <tbody id="dayBody"></tbody>
      </table>
    </div>
  </div>
</div>

<button class="help-btn" id="helpBtn">?</button>

<script>
/* =========================
   ë‚ ì§œ/ì‹œê°„ ìœ í‹¸ (ì•„ì´í°/í•œêµ­ì‹œê°„ ì•ˆì „)
========================= */
function parseDate(v){
  if(!v) return null;
  const [y,m,d] = v.split('-').map(Number);
  return new Date(y, m-1, d);
}
function pad2(n){ return String(n).padStart(2,'0'); }
function isoLocal(d){
  return d.getFullYear() + "-" + pad2(d.getMonth()+1) + "-" + pad2(d.getDate());
}

/* =========================
   ì„¤ì •(ë„ˆê°€ ìš´ì˜í•˜ë©´ì„œ ìˆ˜ì •í•˜ëŠ” êµ¬ê°„)
========================= */

// ì‹œì‘ì¼(ì´ì „ì€ ì¡°íšŒ ë¶ˆê°€)
const START = new Date(2026,0,5);

// âœ… íœ´ë¬´ì¼(ëª…ì ˆ ë“±)
const HOLIDAYS = [
  "2026-02-16","2026-02-17","2026-02-18","2026-02-19"
];

// âœ… "ëª…ë‹¨/ì‘ì—…" ë³€ê²½ì´ ì ìš©ë˜ëŠ” ê¸°ì¤€ì¼(19ì¼ë¶€í„° ë°˜ì˜)
const CHANGE_DATE_1 = new Date(2026,0,19);

// 19ì¼ë¶€í„° ì ìš©ë˜ëŠ” ì‘ì—…ì ìˆœì„œ(ì¤€í˜„-ë¬¸ì •-ì„œì§„)
const names_v2 = [
  "ì˜í›ˆ","ê°‘ìˆ˜","ê¸°ë°±","ìš°ë¹ˆ","ìŠ¹í˜¸","ì›…ê¸°","í•™í˜„","ë²”ì„±","ì„±í•´",
  "ì‘ê·œ","ì˜í™˜","ìƒê±´","ì¬ë•","ì˜¥ì—°","ìˆ˜ì‹ ","ì˜¤ì±„","ì€ìš°","ì •í›ˆ","ìš©ë‚¨",
  "ì„±í›ˆ","ì›ë¹ˆ","ê¸¸ìš´","ëŒ€í˜„","ì§„ì†”","ì¤€í˜„","ë¬¸ì •","ì„œì§„","ì´ìŠ¬","ë¯¼êµ­","ì„±ì²œ","ì¶©í›ˆ"
];

// 19ì¼ë¶€í„° ì ìš©ë˜ëŠ” ì‘ì—… ìˆœì„œ(ASì»¤ë²„ ë‹¤ìŒì— ì¡±ì¥(SCU))
const tasks_v2 = [
  "LHíœ€ë‹¤","LH Bí•„ë¼","Lì—ì–´ë°±íˆ¬ì…","2ì¡°1ë²ˆ","LH Cí•„ë¼",
  "SKì£¼ìœ êµ¬","ë©¤ë²„ì–´ìŠ¤","LH Aí•„ë¼","ë§ˆìŠ¤í„°ë°±","Lë„ì–´íƒˆê±°",
  "ë‚š1","ë²”í¼ê°€ì´ë“œ","2ì¡°2ë²ˆ","ASì»¤ë²„","ì¡±ì¥(SCU)","LH ë£¨1","LH ë£¨2",
  "RH íœ€ë‹¤","RH Bí•„ë¼","Rì—ì–´ë°±íˆ¬ì…","RH Cí•„ë¼","R Aí•„ë¼",
  "í›„ë“œ","3ì¡°1ë²ˆ","Rë„ì–´íƒˆê±°","í•˜ì´ë“œë¡œë‹‰ì²´ê²°","ë‚š2","ì—”ì§„ì–´ìŠ¤",
  "3ì¡°2ë²ˆ","RH ë£¨1","RH ë£¨2"
];

// âœ… ê¸°ì¤€ì¼/ê¸°ì¤€ë§¤ì¹­(19ì¼ LHíœ€ë‹¤ ë‹´ë‹¹ì = ìƒê±´)
const BASE_DATE = new Date(2026,0,19);
const BASE_TASK = "LHíœ€ë‹¤";
const BASE_PERSON = "ìƒê±´";

// âœ… ë¼ìš´ë“œ â€œí•œ ì¹¸ ë°€ë¦¼â€ ì´ë²¤íŠ¸(1/22 4R ë¯¸ì‹¤ì‹œ â†’ 1/23 1Rë¡œ ì´ì›”)
// shift = +1  (ê·¸ ë‹¤ìŒ ê·¼ë¬´ì¼ë¶€í„° ì „ì²´ê°€ 1ì¹¸ ë°€ë¦¼)
const ROUND_SHIFT_EVENTS = [
  { date: "2026-01-22", shift: 1 }
];

/* =========================
   ê·¼ë¬´ì¼/ì¸ë±ìŠ¤/ì´ë²¤íŠ¸ ëˆ„ì 
========================= */
function isWork(d){
  if(d < START) return false;
  if(d.getDay() === 0) return false;     // ì¼ìš”ì¼ íœ´ë¬´
  return !HOLIDAYS.includes(isoLocal(d));
}
function workIndex(d){
  if(!isWork(d)) return null;
  let i = -1;
  let t = new Date(START.getTime());
  while(t <= d){
    if(isWork(t)) i++;
    if(isoLocal(t) === isoLocal(d)) return i;
    t.setDate(t.getDate() + 1);
  }
  return null;
}

// íŠ¹ì • ë‚ ì§œ ì´ì „ê¹Œì§€ ëˆ„ì  shift(ê·¼ë¬´ì¼ ê¸°ì¤€ìœ¼ë¡œ "ê·¸ ë‚ ì§œ ë‹¤ìŒ ê·¼ë¬´ì¼ë¶€í„°" ì ìš©)
function cumulativeShiftBefore(date){
  const w = workIndex(date);
  if(w === null) return 0;

  let sum = 0;
  for(const ev of ROUND_SHIFT_EVENTS){
    const ed = parseDate(ev.date);
    const ew = workIndex(ed);
    if(ew !== null && ew < w){
      sum += (ev.shift || 0);
    }
  }
  return sum;
}

/* =========================
   ìŠ¤ì¼€ì¤„ ê³„ì‚°
   - 19ì¼ë¶€í„° names_v2 / tasks_v2 ì‚¬ìš©
   - BASE_DATE(1/19)ì—ì„œ BASE_PERSON=ìƒê±´ì´ BASE_TASK=LHíœ€ë‹¤ì¸ ìƒíƒœë¥¼ â€œê³ ì •â€
   - ê·¼ë¬´ì¼ì´ í•˜ë£¨ ì§€ë‚˜ë©´ 4ë¼ìš´ë“œì”© ì´ë™
   - ROUND_SHIFT_EVENTS ëˆ„ì ë§Œí¼ ì¶”ê°€ë¡œ ì´ë™(=í•œì¹¸ ë°€ë¦¼)
========================= */
function getActiveDataForDate(d){
  // ì§€ê¸ˆì€ 19ì¼ë¶€í„°ë§Œ ì œëŒ€ë¡œ ì“°ëŠ” ìƒíƒœë¼ì„œ(ë„ˆê°€ ì›í•˜ëŠ” ì •í™• ë°ì´í„° êµ¬ê°„)
  // 19ì¼ ì´ì „ì„ ë³´ê³  ì‹¶ìœ¼ë©´ v1 ë°ì´í„°ë„ ë§Œë“¤ì–´ì„œ ì—¬ê¸°ì„œ ë¶„ê¸°í•˜ë©´ ë¨.
  return { names: names_v2, tasks: tasks_v2 };
}

function getSchedule(d){
  if(!isWork(d)) return null;

  const { names, tasks } = getActiveDataForDate(d);

  const todayIdx = workIndex(d);
  const baseIdx  = workIndex(BASE_DATE);
  if(todayIdx === null || baseIdx === null) return null;

  const baseTaskIdx   = tasks.indexOf(BASE_TASK);
  const basePersonIdx = names.indexOf(BASE_PERSON);
  if(baseTaskIdx < 0 || basePersonIdx < 0) return null;

  // ê¸°ë³¸ ì´ë™(ê·¼ë¬´ì¼ ì°¨ì´ * 4ë¼ìš´ë“œ)
  const dayShift = (todayIdx - baseIdx) * 4;

  // âœ… ë¼ìš´ë“œ ë°€ë¦¼ ì´ë²¤íŠ¸ ëˆ„ì 
  const extraShift = cumulativeShiftBefore(d);

  // ìµœì¢… ì´ë™ëŸ‰
  const totalShift = dayShift + extraShift;

  return names.map((name, personIdx)=>{
    const rounds = [];
    for(let r=0; r<4; r++){
      const taskIdx =
        (baseTaskIdx + totalShift + r + (personIdx - basePersonIdx) + tasks.length)
        % tasks.length;
      rounds.push(tasks[taskIdx]);
    }
    return { name, rounds };
  });
}

/* =========================
   í™”ë©´ ì¶œë ¥
========================= */
function renderDay(){
  const d = parseDate(document.getElementById("dayDate").value);
  const dayBody = document.getElementById("dayBody");
  const dayWarn = document.getElementById("dayWarn");
  dayBody.innerHTML = "";

  if(!d || !isWork(d)){
    dayWarn.textContent = "íœ´ë¬´ì¼ì…ë‹ˆë‹¤.";
    return;
  }

  const s = getSchedule(d);
  if(!s){
    dayWarn.textContent = "ìŠ¤ì¼€ì¤„ ê³„ì‚°ì— ë¬¸ì œê°€ ìˆì–´ìš”. (ê¸°ì¤€ ì‘ì—…/ì‘ì—…ì/ë°ì´í„° í™•ì¸ í•„ìš”)";
    return;
  }

  dayWarn.textContent = "";
  s.forEach(r=>{
    dayBody.innerHTML += `
      <tr>
        <td class="name-col">${r.name}</td>
        <td class="round-1">${r.rounds[0]}</td>
        <td class="round-2">${r.rounds[1]}</td>
        <td class="round-3">${r.rounds[2]}</td>
        <td class="round-4">${r.rounds[3]}</td>
      </tr>
    `;
  });
}

function goToday(){
  const t = new Date();
  const d = isWork(t) ? t : START;
  document.getElementById("dayDate").value = isoLocal(d);
  renderDay();
}

document.getElementById("helpBtn").addEventListener("click", ()=>{
  alert(
    "ë§Œë“ ì‚¬ëŒ : ê¹€ì´ìŠ¬\n" +
    "ë²„ì „ : vFinal\n" +
    "ìµœì¢… ìˆ˜ì •ì¼ : 2026-01-19"
  );
});

goToday();
</script>
</body>
</html>