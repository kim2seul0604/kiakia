<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>트림2반 작업 스케줄 조회</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:#f5f5f7;
  color:#222;
}

header {
  background:#111;
  color:#fff;
  padding:16px;
  text-align:center;
  position:sticky;
  top:0;
  z-index:10;
}

.today-btn {
  margin-top:10px;
  padding:8px 18px;
  border:none;
  border-radius:999px;
  background:#0a8a43;
  color:#fff;
}

.container {
  max-width:960px;
  margin:0 auto;
  padding:16px;
}

.card {
  background:#fff;
  border-radius:16px;
  padding:14px;
  margin-bottom:16px;
  box-shadow:0 6px 16px rgba(0,0,0,.06);
}

h2 { font-size:16px; margin-bottom:10px; }

input, select {
  padding:6px 10px;
  font-size:14px;
  border-radius:8px;
  border:1px solid #ccc;
  margin-bottom:6px;
}

button.primary {
  padding:8px 16px;
  border-radius:999px;
  border:none;
  background:#007aff;
  color:#fff;
}

.warning {
  color:#c00;
  font-size:13px;
  margin-top:6px;
}

.table-wrap {
  overflow-x:auto;
  margin-top:8px;
}

table {
  border-collapse:collapse;
  min-width:600px;
  width:max-content;
  font-size:11.5px;
}

th, td {
  padding:6px 8px;
  border-bottom:1px solid #eee;
  text-align:center;
  white-space:nowrap;
}

th { background:#fafafa; }

.name-col {
  position:sticky;
  left:0;
  background:#fff;
  font-weight:700;
  z-index:2;
}

/* 라운드 색상 */
.round-1 { color:#aaa; }
.round-2 { color:#777; }
.round-3 { color:#444; }
.round-4 { color:#000; font-weight:600; }
</style>
</head>

<body>

<header>
  <div style="font-size:22px;font-weight:800;">트림2반 작업 스케줄 조회</div>
  <button class="today-btn" onclick="goToday()">오늘</button>
</header>

<div class="container">

<!-- ① 하루 전체 -->
<div class="card">
<h2>① 하루 전체 스케줄 보기</h2>
<input type="date" id="dayDate">
<button class="primary" onclick="renderDay()">조회</button>
<div id="dayWarn" class="warning"></div>

<div class="table-wrap">
<table>
<thead>
<tr>
<th class="name-col">이름</th>
<th>1R</th><th>2R</th><th>3R</th><th>4R</th>
</tr>
</thead>
<tbody id="dayBody"></tbody>
</table>
</div>
</div>

<!-- ② 작업 → 담당자 -->
<div class="card">
<h2>② 날짜 + 라운드 + 작업 → 담당자</h2>
<input type="date" id="findDate"><br>
<select id="findRound">
<option value="0">1라운드</option>
<option value="1">2라운드</option>
<option value="2">3라운드</option>
<option value="3">4라운드</option>
</select><br>
<select id="task1"></select><br>
<select id="task2"></select><br>
<select id="task3"></select><br>
<button class="primary" onclick="findPerson()">찾기</button>
<div id="findResult"></div>
</div>

<!-- ③ 개인 작업 -->
<div class="card">
<h2>③ 날짜 + 작업자 → 개인 작업</h2>
<input type="date" id="personDate"><br>
<select id="p1"></select><br>
<select id="p2"></select><br>
<select id="p3"></select><br>
<button class="primary" onclick="showPerson()">조회</button>
<div id="personResult"></div>
</div>

</div>

<script>
/* ===== 기준 ===== */
const START = new Date(2026,0,5);

const HOLIDAYS = [
  "2026-02-16","2026-02-17","2026-02-18","2026-02-19"
];

const names = [
"영훈","갑수","기백","우빈","승호","웅기","학현","범성","성해",
"응규","영환","상건","재덕","옥연","수신","오채","은우","정훈","용남",
"성훈","원빈","길운","대현","진솔","서진","이슬","민국","성천","충훈"
];

const tasks = [
"LH휀다","LH B필라","L에어백투입","2조1번","LH C필라",
"SK주유구","멤버어스","LH A필라","마스터백","L도어탈거",
"낚1","범퍼가이드","2조2번","AS커버","LH 루1","LH 루2",
"RH 휀다","RH B필라","R에어백투입","RH C필라","R A필라",
"후드","3조1번","하이드로닉체결","낚2","엔진어스",
"3조2번","RH 루1","RH 루2"
];

/* ===== 유틸 ===== */
function iso(d){ return d.toISOString().slice(0,10); }

function isWork(d){
  if(d < START) return false;
  if(d.getDay() === 0) return false;
  return !HOLIDAYS.includes(iso(d));
}

function workIndex(d){
  if(!isWork(d)) return null;
  let idx = -1;
  let t = new Date(START);
  while(t <= d){
    if(isWork(t)) idx++;
    if(iso(t) === iso(d)) return idx;
    t.setDate(t.getDate()+1);
  }
  return null;
}

/* ===== 스케줄 ===== */
function getSchedule(d){
  const idx = workIndex(d);
  if(idx === null) return null;

  return names.map((name,i)=>{
    const rounds=[];
    for(let r=0;r<4;r++){
      rounds.push(tasks[(i + idx*4 + r) % tasks.length]);
    }
    return { name, rounds };
  });
}

/* ===== 기능 ===== */
function renderDay(){
  if(!dayDate.value){
    dayWarn.textContent="날짜를 선택하세요.";
    return;
  }
  const d=new Date(dayDate.value);
  dayBody.innerHTML="";
  if(!isWork(d)){
    dayWarn.textContent="휴무일입니다.";
    return;
  }
  dayWarn.textContent="";
  getSchedule(d).forEach(r=>{
    dayBody.innerHTML+=`
    <tr>
      <td class="name-col">${r.name}</td>
      <td class="round-1">${r.rounds[0]}</td>
      <td class="round-2">${r.rounds[1]}</td>
      <td class="round-3">${r.rounds[2]}</td>
      <td class="round-4">${r.rounds[3]}</td>
    </tr>`;
  });
}

function findPerson(){
  if(!findDate.value) return;
  const d=new Date(findDate.value);
  if(!isWork(d)) return;
  const s=getSchedule(d);
  const r=findRound.value;
  const sel=[task1,task2,task3].map(x=>x.value).filter(Boolean);
  findResult.innerHTML="";
  sel.forEach(t=>{
    const p=s.find(x=>x.rounds[r]===t);
    findResult.innerHTML+=`${t} → ${p?p.name:"없음"}<br>`;
  });
}

function showPerson(){
  if(!personDate.value) return;
  const d=new Date(personDate.value);
  if(!isWork(d)) return;
  const s=getSchedule(d);
  const sel=[p1,p2,p3].map(x=>x.value).filter(Boolean);
  personResult.innerHTML="";
  sel.forEach(n=>{
    const r=s.find(x=>x.name===n);
    personResult.innerHTML+=`
    <b>${n}</b><br>
    1R ${r.rounds[0]}<br>
    2R ${r.rounds[1]}<br>
    3R ${r.rounds[2]}<br>
    4R ${r.rounds[3]}<hr>`;
  });
}

/* ===== 초기화 ===== */
function fillSorted(sel, arr){
  sel.innerHTML="<option value=''>- 선택 -</option>";
  [...arr].sort((a,b)=>a.localeCompare(b,"ko")).forEach(v=>{
    sel.innerHTML+=`<option>${v}</option>`;
  });
}

fillSorted(task1,tasks); fillSorted(task2,tasks); fillSorted(task3,tasks);
fillSorted(p1,names); fillSorted(p2,names); fillSorted(p3,names);

function goToday(){
  const t=new Date();
  const d=isWork(t)?t:START;
  dayDate.value=iso(d);
  findDate.value=iso(d);
  personDate.value=iso(d);
  renderDay();
}
goToday();
</script>

</body>
</html>