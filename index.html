<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --primary-blue: #007aff;
      --bg-gray: #f5f5f7;
      --border-gray: #dddddd;
      --header-dark: #111111;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      background: var(--bg-gray);
      position: relative;
      overflow-x: hidden;
      color: #222;
    }

    /* ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¸ë¦¬ ë°°ê²½ */
    .christmas-bg-tree {
      position: fixed;
      right: 5%;
      bottom: 5%;
      font-size: 140px;
      opacity: 0.07;
      pointer-events: none;
      z-index: 1;
    }

    /* â„ ëˆˆì†¡ì´ */
    .snowflake {
      position: fixed;
      top: -10vh;
      color: white;
      font-size: 12px;
      opacity: 0.8;
      pointer-events: none;
      z-index: 10;
      animation-name: snow-fall;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }

    @keyframes snow-fall {
      0% { transform: translateY(-10vh); }
      100% { transform: translateY(110vh); }
    }

    /* í—¤ë” */
    .header {
      background: var(--header-dark);
      color: white;
      padding: 16px 12px;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 20;
      box-shadow: 0 4px 12px rgba(0,0,0,0.35);
    }

    .header-title {
      font-size: 22px;
      font-weight: 800;
      margin-bottom: 12px;
      width: 100%;
      text-align: center;
    }

    .today-btn {
      padding: 8px 18px;
      border-radius: 999px;
      border: none;
      background: #0a8a43; /* ê¸°ì¡´ ìƒ‰ ìœ ì§€ */
      color: #fff;
      font-size: 14px;
      display: inline-block;
      margin: 0 auto;
    }

    .today-btn:active { transform: scale(0.97); }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 16px;
      position: relative;
      z-index: 5;
    }

    h2 {
      font-size: 16px;
      margin: 18px 0 8px;
      color: #111;
    }

    .card {
      background: #fff;
      border-radius: 16px;
      padding: 12px 14px;
      margin-bottom: 14px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.04);
      border: 1px solid var(--border-gray);
    }

    label {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
      display: inline-block;
    }

    input[type="date"], select {
      padding: 6px 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
      margin-bottom: 6px;
      max-width: 100%;
      box-sizing: border-box;
    }

    button.primary-btn {
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      background: var(--primary-blue);
      color: #fff;
      font-size: 14px;
      margin-top: 4px;
    }

    button.primary-btn:active { transform: scale(0.97); }

    .weekday-label {
      font-size: 12px;
      color: #555;
      margin-left: 4px;
    }

    .info {
      font-size: 12px;
      color: #666;
      margin-top: 4px;
      line-height: 1.45;
    }

    .warning {
      font-size: 13px;
      color: #c00;
      margin-top: 8px;
    }

    /* í…Œì´ë¸” */
    .table-wrapper {
      width: 100%;
      overflow-x: auto;
      margin-top: 8px;
      border-radius: 12px;
      border: 1px solid #eee;
      position: relative;
      background: #fff;
    }

    table {
      border-collapse: collapse;
      min-width: 600px;
      font-size: 13px;
      width: max-content;
    }

    th, td {
      border-bottom: 1px solid #eee;
      padding: 6px 8px;
      white-space: nowrap;
      text-align: center;
      background: #fff;
    }

    th {
      background: #fafafa;
      font-weight: 700;
    }

    /* ì´ë¦„ ì»¬ëŸ¼ ê³ ì • (sticky) */
    .daily-table th.name-col,
    .daily-table td.name-col {
      position: sticky;
      left: 0;
      background: #fff;
      z-index: 5;
      text-align: left;
    }

    .daily-table thead th.name-col { z-index: 6; }

    .result {
      margin-top: 8px;
      font-size: 14px;
      font-weight: 600;
      line-height: 1.4;
    }

    /* â‘  ê²°ê³¼(ì‘ì—…ëª… â†’ ë‹´ë‹¹ì) ì •ë¦¬ìš© */
    .result-header {
      font-size: 13px;
      color: #555;
      margin-top: 6px;
      margin-bottom: 4px;
    }

    .result-list {
      margin-top: 4px;
      border-radius: 10px;
      background: #fafafa;
      padding: 6px 8px;
      border: 1px solid #eee;
    }

    .result-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 0;
      border-bottom: 1px solid #eee;
      font-size: 13px;
      gap: 8px;
    }

    .result-row:last-child { border-bottom: none; }

    .result-task { flex: 2; text-align: left; }
    .result-arrow { flex: 0; color: #999; }
    .result-person { flex: 1; text-align: right; }

    .result .name {
      color: var(--primary-blue);
      font-weight: 700;
    }

    /* ë„ì›€ë§ ë²„íŠ¼ (ìš°ì¸¡ í•˜ë‹¨) */
    .help-btn {
      position: fixed;
      bottom: 12px;
      right: 12px;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: none;
      background: var(--primary-blue);
      color: #fff;
      font-size: 20px;
      font-weight: 700;
      box-shadow: 0 4px 10px rgba(0,0,0,0.25);
      z-index: 30;
      transform: none;
    }

    .help-btn:active { transform: scale(0.96); }

    @media (max-width: 600px) {
      .container { padding: 12px; }
      table { font-size: 12px; }
    }
  </style>
</head>

<body>
  <!-- ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¸ë¦¬ ë°°ê²½ -->
  <div class="christmas-bg-tree">ğŸ„</div>

  <!-- í—¤ë” -->
  <header class="header">
    <div class="header-title">íŠ¸ë¦¼2ë°˜ ì‘ì—… ìŠ¤ì¼€ì¤„ ì¡°íšŒ</div>
    <button class="today-btn" id="surveyBtn">ğŸ“‹ íŠ¹ê·¼ ì°¸ì—¬ ì¡°ì‚¬</button>
  </header>

  <div class="container">

    <!-- â‘  ë‚ ì§œ + ë¼ìš´ë“œ + ì‘ì—…ëª… â†’ ë‹´ë‹¹ì -->
    <div class="card">
      <h2>â‘  ë‚ ì§œ + ë¼ìš´ë“œ + ì‘ì—…ëª…ìœ¼ë¡œ ë‹´ë‹¹ì ì°¾ê¸°</h2>

      <div>
        <label for="lookupDate">ë‚ ì§œ</label><br/>
        <input type="date" id="lookupDate" />
        <span id="lookupDateWeekday" class="weekday-label"></span>
      </div>

      <div>
        <label for="lookupRound">ë¼ìš´ë“œ</label><br/>
        <select id="lookupRound">
          <option value="1">1ë¼ìš´ë“œ</option>
          <option value="2">2ë¼ìš´ë“œ</option>
          <option value="3">3ë¼ìš´ë“œ</option>
          <option value="4">4ë¼ìš´ë“œ</option>
        </select>
      </div>

      <div>
        <label>ì‘ì—…ëª… (ìµœëŒ€ 3ê°œ)</label><br/>
        <select id="lookupTask1"></select><br/>
        <select id="lookupTask2"></select><br/>
        <select id="lookupTask3"></select>
      </div>

      <button class="primary-btn" id="lookupBtn">ë‹´ë‹¹ì ì°¾ê¸°</button>
      <div id="lookupWarning" class="warning" style="display:none;"></div>
      <div id="lookupResult" class="result"></div>
    </div>

    <!-- â‘¡ ë‚ ì§œ + ì‘ì—…ì â†’ ê°œì¸ ì‘ì—… -->
    <div class="card">
      <h2>â‘¡ ë‚ ì§œ + ì‘ì—…ì ì‘ì—… ë³´ê¸°</h2>

      <div>
        <label for="personDate">ë‚ ì§œ</label><br/>
        <input type="date" id="personDate" />
        <span id="personDateWeekday" class="weekday-label"></span>
      </div>

      <div>
        <label>ì‘ì—…ì ì„ íƒ (ìµœëŒ€ 3ëª…)</label><br/>
        <select id="personName1"></select><br/>
        <select id="personName2"></select><br/>
        <select id="personName3"></select>
      </div>

      <button class="primary-btn" id="personBtn">ê°œì¸ ì‘ì—… ì¡°íšŒ</button>
      <div id="personWarning" class="warning" style="display:none;"></div>
      <div id="personResult" class="result"></div>
    </div>

    <!-- â‘¢ í•˜ë£¨ ì „ì²´ ìŠ¤ì¼€ì¤„ -->
    <div class="card">
      <h2>â‘¢ í•˜ë£¨ ì „ì²´ ìŠ¤ì¼€ì¤„ ë³´ê¸°</h2>

      <div>
        <label for="dateInput">ë‚ ì§œ</label><br/>
        <input type="date" id="dateInput" />
        <span id="dateInputWeekday" class="weekday-label"></span>
        <button class="primary-btn" id="showDayBtn">ì¡°íšŒ</button>
      </div>

      <div class="info">

        âœ… ì¼ìš”ì¼ íœ´ë¬´<br/>
      </div>

      <div id="dailyWarning" class="warning" style="display:none;"></div>

      <div class="table-wrapper">
        <table class="daily-table">
          <thead>
            <tr>
              <th class="name-col">ì´ë¦„</th>
              <th>1ë¼ìš´ë“œ</th>
              <th>2ë¼ìš´ë“œ</th>
              <th>3ë¼ìš´ë“œ</th>
              <th>4ë¼ìš´ë“œ</th>
            </tr>
          </thead>
          <tbody id="dailyTableBody"></tbody>
        </table>
      </div>
    </div>

  </div>

  <!-- ë„ì›€ë§ ë²„íŠ¼ -->
  <button class="help-btn" id="helpBtn">?</button>

  <script>
    // ===== ê¸°ë³¸ ë°ì´í„° =====
    const names = [
      "ì„±í›ˆ","ì›ë¹ˆ","ê¸¸ìš´","ëŒ€í˜„","ì§„ì†”","ì„œì§„","ì´ìŠ¬","ë¯¼êµ­","ì„±ì²œ",
      "ì¶©í›ˆ","ê°‘ìˆ˜","ê¸°ë°±","ìš°ë¹ˆ","ìŠ¹í˜¸","ì›…ê¸°","í•™í˜„","ë²”ì„±","ì„±í•´",
      "ì‘ê·œ","ì˜í™˜","ìƒê±´","ì¬ë•","ì˜¥ì—°","ìˆ˜ì‹ ","ì˜¤ì±„","ì¢…ìµ","ìš©ë‚¨"
    ];

    const taskNames = [
      "LH Bí•„ë¼","Lì—ì–´ë°±íˆ¬ì…","2ì¡°1ë²ˆ","LH Cí•„ë¼","SKì£¼ìœ êµ¬","ë©¤ë²„ì–´ìŠ¤",
      "LH Aí•„ë¼","ë§ˆìŠ¤í„°ì‹¤ë¦°ë”","ë„ì–´íƒˆê±°","ë‚š1","ë²”í¼ê°€ì´ë“œ","2ì¡°2ë²ˆ",
      "ASì»¤ë²„","LH ë£¨1","LH ë£¨2","RH Bí•„ë¼","Rì—ì–´ë°±íˆ¬ì…","RH Cí•„ë¼",
      "RH Aí•„ë¼","í›„ë“œ","3ì¡°1ë²ˆ","í•˜ì´ë“œë¡œë‹‰ì²´ê²°","ë‚š2","ì—”ì§„ì–´ìŠ¤",
      "3ì¡°2ë²ˆ","RH ë£¨1","RH ë£¨2"
    ];

    // âœ… ì‹œì‘ì¼ë§Œ ê³ ì •(ì´í›„ ë¬´ê¸°í•œ ì‚¬ìš©)
    const START_DATE = new Date(2025, 11, 1); // 2025-12-01

    // âœ… íœ´ë¬´ì¼(í•„ìš”í•˜ë©´ ê³„ì† ì¶”ê°€ ê°€ëŠ¥)
    const HOLIDAYS = ["2025-12-12","2025-12-25","2026-01-01","2026-01-02","2026-01-03"];

    // âœ… íŠ¹ìˆ˜ì¼: í•´ë‹¹ ë¼ìš´ë“œ X + ì´í›„ ëˆ„ì  ë°€ë¦¼(+1ì”©)
    const SPECIAL_DAYS = [
      { date: "2025-12-09", xRound: 2 },
      { date: "2025-12-19", xRound: 4 }
    ];

    const weekdayNames = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];

    // ===== ë‚ ì§œ ìœ í‹¸ =====
    function pad2(n){ return n.toString().padStart(2,"0"); }

    function formatDateISO(d){
      return d.getFullYear()+"-"+pad2(d.getMonth()+1)+"-"+pad2(d.getDate());
    }

    function parseDateInput(v){
      if(!v) return null;
      const p=v.split("-");
      if(p.length!==3) return null;
      const y=parseInt(p[0],10), m=parseInt(p[1],10), d=parseInt(p[2],10);
      if(isNaN(y)||isNaN(m)||isNaN(d)) return null;
      return new Date(y,m-1,d);
    }

    function formatKoreanWeekday(date){
      if(!date) return "";
      return "("+weekdayNames[date.getDay()]+")";
    }

    function updateWeekdayLabel(inputId,labelId){
      const val=document.getElementById(inputId).value;
      const date=parseDateInput(val);
      document.getElementById(labelId).textContent = formatKoreanWeekday(date);
    }

    function isWorkDay(d){
      const iso = formatDateISO(d);
      if(d < START_DATE) return false;
      if(d.getDay()===0) return false; // ì¼ìš”ì¼
      if(HOLIDAYS.includes(iso)) return false;
      return true;
    }

    // START_DATEë¶€í„° ê·¼ë¬´ì¼ë§Œ ì¹´ìš´íŠ¸í•œ ì¸ë±ìŠ¤
    function getWorkDayIndex(targetDate){
      if(!isWorkDay(targetDate)) return null;

      let idx = -1;
      let d = new Date(START_DATE.getTime());

      while(d <= targetDate){
        if(isWorkDay(d)){
          idx++;
          if(formatDateISO(d) === formatDateISO(targetDate)) return idx;
        }
        d.setDate(d.getDate()+1);
      }
      return null;
    }

    // ì˜¤ëŠ˜ ì´ì „ê¹Œì§€ íŠ¹ìˆ˜ì¼ì´ ëª‡ ë²ˆ ìˆì—ˆëŠ”ì§€(=ëˆ„ì  ë°€ë¦¼ ìˆ˜)
    function getShiftOffsetUntil(date){
      const w = getWorkDayIndex(date);
      if(w === null) return 0;

      let offset = 0;
      for(const s of SPECIAL_DAYS){
        const sd = parseDateInput(s.date);
        const sw = getWorkDayIndex(sd);
        if(sw !== null && sw < w) offset += 1;
      }
      return offset;
    }

    // âœ… í•µì‹¬ ìŠ¤ì¼€ì¤„ ê³„ì‚° (íŠ¹ìˆ˜ì¼ + ëˆ„ì  ë°€ë¦¼ ë°˜ì˜)
    function getDailySchedule(date){
      if(!isWorkDay(date)) return null;

      const workIdx = getWorkDayIndex(date);
      if(workIdx === null) return null;

      const iso = formatDateISO(date);

      // ì˜¤ëŠ˜ ì´ì „ê¹Œì§€ ëˆ„ì  ë°€ë¦¼ ë°˜ì˜
      const shiftOffset = getShiftOffsetUntil(date);

      // ê¸°ë³¸ 4ë¼ìš´ë“œ (ëˆ„ì  ë°€ë¦¼ ì ìš©)
      const base = names.map((person,i)=>{
        const rounds = [];
        const baseOffset = workIdx * 4 - shiftOffset;

        for(let r=0;r<4;r++){
          const taskIdx = (i + baseOffset + r) % taskNames.length;
          rounds.push(taskNames[taskIdx]);
        }
        return { person, rounds };
      });

      // ì˜¤ëŠ˜ì´ íŠ¹ìˆ˜ì¼ì´ë©´ Xì²˜ë¦¬ + ì´í›„ ë¼ìš´ë“œ ë‹¹ê¸°ê¸°
      const special = SPECIAL_DAYS.find(s => s.date === iso);
      if(!special) return base;

      const xIdx = special.xRound - 1; // 0~3

      return base.map(row=>{
        const newRounds = [...row.rounds];

        newRounds[xIdx] = "X";
        for(let i=xIdx+1;i<4;i++){
          newRounds[i] = row.rounds[i-1];
        }
        return { person: row.person, rounds: newRounds };
      });
    }

    // ê³µí†µ: ê·¼ë¬´ì¼ ì²´í¬ ê²½ê³ 
    function showNotWorkdayWarning(date, warningEl){
      warningEl.style.display = "block";
      if(date < START_DATE){
        warningEl.textContent = "2025-12-01 ì´í›„ ë‚ ì§œë¶€í„° ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤.";
      } else if(date.getDay()===0){
        warningEl.textContent = "ì¼ìš”ì¼ì€ ê·¼ë¬´ì¼ì´ ì•„ë‹™ë‹ˆë‹¤.";
      } else if(HOLIDAYS.includes(formatDateISO(date))){
        warningEl.textContent = "ì§€ì •ëœ íœ´ë¬´ì¼ì€ ê·¼ë¬´ì¼ì´ ì•„ë‹™ë‹ˆë‹¤.";
      } else {
        warningEl.textContent = "ê·¼ë¬´ì¼ì´ ì•„ë‹™ë‹ˆë‹¤.";
      }
    }

    // ===== â‘¢ í•˜ë£¨ ì „ì²´ ìŠ¤ì¼€ì¤„ ë Œë” =====
    function renderDailySchedule(){
      const val = document.getElementById("dateInput").value;
      const date = parseDateInput(val);
      const warning = document.getElementById("dailyWarning");
      const tbody = document.getElementById("dailyTableBody");

      tbody.innerHTML = "";
      warning.style.display = "none";
      warning.textContent = "";

      updateWeekdayLabel("dateInput","dateInputWeekday");

      if(!date){
        warning.style.display="block";
        warning.textContent="ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";
        return;
      }

      if(!isWorkDay(date)){
        showNotWorkdayWarning(date, warning);
        return;
      }

      const schedule = getDailySchedule(date);
      if(!schedule || !schedule.length){
        warning.style.display="block";
        warning.textContent="í•´ë‹¹ ë‚ ì§œì˜ ìŠ¤ì¼€ì¤„ì´ ì—†ìŠµë‹ˆë‹¤.";
        return;
      }

      schedule.forEach(row=>{
        const tr = document.createElement("tr");

        const tdName = document.createElement("td");
        tdName.className = "name-col";
        tdName.textContent = row.person;
        tr.appendChild(tdName);

        row.rounds.forEach(task=>{
          const td = document.createElement("td");
          td.textContent = task;
          tr.appendChild(td);
        });

        tbody.appendChild(tr);
      });
    }

    // ===== â‘  ë‚ ì§œ + ë¼ìš´ë“œ + ì‘ì—…ëª…ë“¤(ìµœëŒ€ 3ê°œ) â†’ ë‹´ë‹¹ì ì°¾ê¸° =====
    function findPersonByDateRoundTask(){
      const dateVal  = document.getElementById("lookupDate").value;
      const roundVal = document.getElementById("lookupRound").value;
      const warning  = document.getElementById("lookupWarning");
      const result   = document.getElementById("lookupResult");

      warning.style.display = "none";
      warning.textContent   = "";
      result.textContent    = "";

      updateWeekdayLabel("lookupDate","lookupDateWeekday");

      const date = parseDateInput(dateVal);
      if(!date){
        warning.style.display = "block";
        warning.textContent   = "ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";
        return;
      }

      if(!isWorkDay(date)){
        showNotWorkdayWarning(date, warning);
        return;
      }

      const schedule = getDailySchedule(date);
      if(!schedule){
        warning.style.display = "block";
        warning.textContent   = "í•´ë‹¹ ë‚ ì§œì˜ ìŠ¤ì¼€ì¤„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        return;
      }

      const roundIdx = parseInt(roundVal,10) - 1;

      const selectedTasks = ["lookupTask1","lookupTask2","lookupTask3"]
        .map(id => document.getElementById(id).value)
        .filter(v => !!v);

      if(selectedTasks.length === 0){
        warning.style.display = "block";
        warning.textContent   = "ì‘ì—…ì„ ìµœì†Œ 1ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.";
        return;
      }

      const weekdayText = formatKoreanWeekday(date);

      let html = "";
      html += `<div class="result-header">${dateVal} ${weekdayText} / ${roundVal}ë¼ìš´ë“œ</div>`;
      html += `<div class="result-list">`;

      selectedTasks.forEach(task=>{
        let found = null;
        for(const row of schedule){
          if(row.rounds[roundIdx] === task){
            found = row.person;
            break;
          }
        }

        html += `
          <div class="result-row">
            <div class="result-task">${task}</div>
            <div class="result-arrow">â†’</div>
            <div class="result-person">${found ? `<span class="name">${found}</span>` : `ë‹´ë‹¹ì ì—†ìŒ`}</div>
          </div>
        `;
      });

      html += `</div>`;
      result.innerHTML = html;
    }

    // ===== â‘¡ ë‚ ì§œ + ì´ë¦„ë“¤ â†’ ê°œì¸ ì‘ì—… ë³´ê¸° (ìµœëŒ€ 3ëª…) =====
    function showPersonSchedule(){
      const dateVal = document.getElementById("personDate").value;
      const warning = document.getElementById("personWarning");
      const result  = document.getElementById("personResult");

      warning.style.display = "none";
      warning.textContent   = "";
      result.textContent    = "";

      updateWeekdayLabel("personDate","personDateWeekday");

      const date = parseDateInput(dateVal);
      if(!date){
        warning.style.display = "block";
        warning.textContent   = "ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";
        return;
      }

      if(!isWorkDay(date)){
        showNotWorkdayWarning(date, warning);
        return;
      }

      const selectedNames = ["personName1","personName2","personName3"]
        .map(id => document.getElementById(id).value)
        .filter(v => !!v);

      if(selectedNames.length === 0){
        warning.style.display = "block";
        warning.textContent   = "ì‘ì—…ìë¥¼ ìµœì†Œ 1ëª… ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.";
        return;
      }

      const schedule = getDailySchedule(date);
      if(!schedule){
        warning.style.display = "block";
        warning.textContent   = "í•´ë‹¹ ë‚ ì§œì˜ ìŠ¤ì¼€ì¤„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        return;
      }

      let html = "";
      selectedNames.forEach((name, idx)=>{
        const row = schedule.find(r => r.person === name);

        if(!row){
          html += `<div><span class="name">${name}</span> : ìŠ¤ì¼€ì¤„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>`;
        }else{
          const [r1,r2,r3,r4] = row.rounds;
          html += `
            <div style="margin-top:${idx===0 ? 0 : 8}px;">
              ${dateVal} ${formatKoreanWeekday(date)} / <span class="name">${name}</span>
            </div>
            <div>1ë¼ìš´ë“œ: ${r1}</div>
            <div>2ë¼ìš´ë“œ: ${r2}</div>
            <div>3ë¼ìš´ë“œ: ${r3}</div>
            <div>4ë¼ìš´ë“œ: ${r4}</div>
          `;
        }

        if(idx !== selectedNames.length - 1){
          html += `<hr style="margin:8px 0; border:none; border-top:1px solid #eee;" />`;
        }
      });

      result.innerHTML = html;
    }

    // â„ ëˆˆ ìƒì„±
    function createSnowflakes(){
      const count=40;
      for(let i=0;i<count;i++){
        const el=document.createElement("span");
        el.className="snowflake";
        el.textContent="â„";
        el.style.left = (Math.random()*100) + "vw";
        el.style.animationDuration = (8+Math.random()*7) + "s";
        el.style.animationDelay = (Math.random()*10) + "s";
        document.body.appendChild(el);
      }
    }

    function goToToday(){
      const today = new Date();
      let target = today;
      if(today < START_DATE){
        target = new Date(START_DATE.getTime());
      }
      const iso = formatDateISO(target);

      document.getElementById("dateInput").value   = iso;
      document.getElementById("lookupDate").value  = iso;
      document.getElementById("personDate").value  = iso;

      updateWeekdayLabel("dateInput","dateInputWeekday");
      updateWeekdayLabel("lookupDate","lookupDateWeekday");
      updateWeekdayLabel("personDate","personDateWeekday");

      renderDailySchedule();
      window.scrollTo({top:0,behavior:"smooth"});
    }

    function init(){
      // ì´ë¦„ ë“œë¡­ë‹¤ìš´ (ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ëœ ë³µì‚¬ë³¸)
      const sortedNamesAsc = [...names].sort((a,b)=>a.localeCompare(b,"ko-KR"));
      ["personName1","personName2","personName3"].forEach(selectId=>{
        const sel = document.getElementById(selectId);
        const emptyOpt = document.createElement("option");
        emptyOpt.value="";
        emptyOpt.textContent="- ì„ íƒ ì•ˆ í•¨ -";
        sel.appendChild(emptyOpt);

        sortedNamesAsc.forEach(n=>{
          const opt=document.createElement("option");
          opt.value=n;
          opt.textContent=n;
          sel.appendChild(opt);
        });
      });

      // ì‘ì—…ëª… ë“œë¡­ë‹¤ìš´ (ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ëœ ë³µì‚¬ë³¸)
      const sortedTasksAsc = [...taskNames].sort((a,b)=>a.localeCompare(b,"ko-KR"));
      ["lookupTask1","lookupTask2","lookupTask3"].forEach(selectId=>{
        const sel = document.getElementById(selectId);
        const emptyOpt = document.createElement("option");
        emptyOpt.value="";
        emptyOpt.textContent="- ì„ íƒ ì•ˆ í•¨ -";
        sel.appendChild(emptyOpt);

        sortedTasksAsc.forEach(t=>{
          const opt=document.createElement("option");
          opt.value=t;
          opt.textContent=t;
          sel.appendChild(opt);
        });
      });

      // ì´ë²¤íŠ¸
      document.getElementById("showDayBtn").addEventListener("click",renderDailySchedule);
      document.getElementById("lookupBtn").addEventListener("click",findPersonByDateRoundTask);
      document.getElementById("personBtn").addEventListener("click",showPersonSchedule);

      // íŠ¹ê·¼ ì°¸ì—¬ ì¡°ì‚¬ í˜ì´ì§€ ì´ë™
      document.getElementById("surveyBtn").addEventListener("click", ()=>{
        window.location.href = "survey.html";
      });

      document.getElementById("dateInput").addEventListener("change", ()=>updateWeekdayLabel("dateInput","dateInputWeekday"));
      document.getElementById("lookupDate").addEventListener("change",()=>updateWeekdayLabel("lookupDate","lookupDateWeekday"));
      document.getElementById("personDate").addEventListener("change",()=>updateWeekdayLabel("personDate","personDateWeekday"));

      // ë„ì›€ë§
      document.getElementById("helpBtn").addEventListener("click", ()=>{
        alert("ë§Œë“ ì‚¬ëŒ : ê¹€ì´ìŠ¬");
      });

      // ëˆˆ íš¨ê³¼
      createSnowflakes();

      // ì²˜ìŒ ë¡œë“œ: ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì„¸íŒ… + ì „ì²´í‘œ ì¶œë ¥
      goToToday();
    }

    window.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>